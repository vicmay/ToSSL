# ::tossl::ed25519::verify

Verify an Ed25519 digital signature using a public key and message.

## Overview

The `::tossl::ed25519::verify` command verifies an Ed25519 digital signature using a public key and message. It returns 1 if the signature is valid, 0 if invalid, and throws an error for malformed input.

## Syntax

```
::tossl::ed25519::verify <public_key_pem> <data> <signature>
```

- `<public_key_pem>`: Ed25519 public key in PEM format
- `<data>`: The message (string or byte array) that was signed
- `<signature>`: The signature as a byte array (output of `::tossl::ed25519::sign`)

## Example

```tcl
set priv [tossl::ed25519::generate]
set pub  [tossl::key::getpub -key $priv]
set data "hello world"
set sig [tossl::ed25519::sign $priv $data]
set ok [tossl::ed25519::verify $pub $data $sig]
if {$ok} {
    puts "Signature valid!"
} else {
    puts "Signature invalid!"
}
```

## Return Value

- Returns `1` (true) if the signature is valid.
- Returns `0` (false) if the signature is invalid.
- Returns an error if the public key or signature is malformed.

## Error Handling

- Returns an error if the public key cannot be parsed.
- Returns an error if the key is not an Ed25519 key.
- Returns an error if the signature format is invalid.
- Returns an error if the wrong number of arguments is provided.

## Security Considerations

- Always use secure, recommended EdDSA keys and never trust a signature without verifying it with the correct public key.
- Handle errors and invalid signatures securely in your application.
- Do not expose private key material or sensitive data in logs or outputs.
- Ed25519 provides deterministic signatures and is resistant to timing attacks.

## Best Practices

- Validate all inputs before calling this command.
- Use signatures and keys generated by secure cryptographic processes.
- Do not expose sensitive data in logs or outputs.
- Always verify signatures before trusting the authenticity of data.

## Algorithm Details

Ed25519 is an elliptic curve digital signature algorithm based on the Edwards-curve Digital Signature Algorithm (EdDSA) using the Curve25519 elliptic curve. It provides:

- **Deterministic signatures**: Same message and key always produce the same signature
- **High security**: 128-bit security level
- **Fast verification**: Optimized for verification speed
- **Compact signatures**: 64-byte signatures
- **Resistance to timing attacks**: Constant-time implementation

## Common Use Cases

### Message Authentication
```tcl
set priv [tossl::ed25519::generate]
set pub [tossl::key::getpub -key $priv]
set message "Important message"
set sig [tossl::ed25519::sign $priv $message]

# Later, verify the message
if {[tossl::ed25519::verify $pub $message $sig]} {
    puts "Message is authentic"
} else {
    puts "Message has been tampered with"
}
```

### Binary Data Verification
```tcl
set priv [tossl::ed25519::generate]
set pub [tossl::key::getpub -key $priv]
set binary_data [binary format H* "0102030405060708"]
set sig [tossl::ed25519::sign $priv $binary_data]

# Verify binary data
if {[tossl::ed25519::verify $pub $binary_data $sig]} {
    puts "Binary data is authentic"
}
```

## Performance Considerations

- Ed25519 verification is very fast, typically faster than RSA verification.
- Signature verification is faster than signature generation.
- The algorithm is optimized for verification speed.
- Memory usage is minimal and constant regardless of message size.

## See Also
- `::tossl::ed25519::sign`
- `::tossl::ed25519::generate`
- `::tossl::key::getpub`
- `::tossl::ed448::verify`
- `::tossl::ed448::sign` 