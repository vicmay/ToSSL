# ::tossl::key::write

Write a key in PEM or DER format.

## Syntax

    tossl::key::write -key <pem> -format <pem|der> -type <private|public>

- `-key <pem>`: The key in PEM format (private or public)
- `-format <pem|der>`: Output format
- `-type <private|public>`: Key type

## Description

Writes a key (private or public) to the specified format. Accepts a PEM-encoded key and outputs either PEM or DER encoding. For private keys, DER output is always PKCS#8 (RFC 5208) format, as produced by the OpenSSL default provider. Traditional/legacy formats are not supported.

## Examples

```tcl
set rsa [tossl::key::generate -type rsa -bits 2048]
set priv_pem [dict get $rsa private]
set pub_pem [dict get $rsa public]

# Write private key as PEM
set out_pem [tossl::key::write -key $priv_pem -format pem -type private]

# Write private key as DER (PKCS#8)
set out_der [tossl::key::write -key $priv_pem -format der -type private]

# Write public key as PEM
set out_pub_pem [tossl::key::write -key $pub_pem -format pem -type public]

# Write public key as DER
set out_pub_der [tossl::key::write -key $pub_pem -format der -type public]
```

## Error Handling

- Returns an error if the key cannot be parsed or if required options are missing.
- Only PEM input is supported for keys generated by the default provider.
- DER output for private keys is always PKCS#8.

## Security Notes

- Only default provider algorithms are supported (RSA, EC, DSA, etc. as available).
- No legacy/old-style key formats are supported.
- Always protect private key material. 