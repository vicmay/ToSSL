# ::tossl::ec::sign

Create an ECDSA signature using a private key, message, and digest algorithm.

## Overview

`::tossl::ec::sign` generates an ECDSA signature for a given message using the specified EC private key and digest algorithm.

## Syntax

```
tossl::ec::sign <private_key_pem> <data> <digest>
```

- `<private_key_pem>`: The EC private key in PEM format.
- `<data>`: The message string to sign.
- `<digest>`: The digest algorithm (e.g., `sha256`).

## Example

```tcl
set keys [tossl::key::generate -type ec -curve prime256v1]
set priv [dict get $keys private]
set data "hello world"
set sig [tossl::ec::sign $priv $data sha256]
# To verify:
set pub [dict get $keys public]
set ok [tossl::ec::verify $pub $data $sig sha256]
if {$ok} {
    puts "Signature valid!"
} else {
    puts "Signature invalid!"
}
```

## Error Handling

- Returns the signature as a binary object if successful.
- Returns an error if the private key or digest algorithm is invalid.

## Security Considerations

- Always use secure, recommended curves and digest algorithms (e.g., `prime256v1`, `sha256`).
- Never expose private key material or sensitive data in logs or outputs.
- Handle errors and exceptions securely in your application.

## Best Practices

- Validate all inputs before calling this command.
- Use keys generated by secure cryptographic processes.
- Store and transmit signatures as binary objects.

## See Also
- `tossl::ec::verify`
- `tossl::key::generate` 