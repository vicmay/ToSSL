# ::tossl::ec::verify

Verify an ECDSA signature using a public key, message, and digest algorithm.

## Overview

`::tossl::ec::verify` checks the validity of an ECDSA signature for a given message and public key using the specified digest algorithm.

## Syntax

```
tossl::ec::verify <public_key_pem> <data> <signature> <digest>
```

- `<public_key_pem>`: The EC public key in PEM format.
- `<data>`: The message string that was signed.
- `<signature>`: The signature as a binary string (output of `tossl::ec::sign`).
- `<digest>`: The digest algorithm (e.g., `sha256`).

## Example

```tcl
set keys [tossl::key::generate -type ec -curve prime256v1]
set priv [dict get $keys private]
set pub  [dict get $keys public]
set data "hello world"
set sig [tossl::ec::sign $priv $data sha256]
set ok [tossl::ec::verify $pub $data $sig sha256]
if {$ok} {
    puts "Signature valid!"
} else {
    puts "Signature invalid!"
}
```

## Error Handling

- Returns 1 if the signature is valid, 0 if invalid.
- Returns an error if the public key or signature is malformed.
- Returns an error if the digest algorithm is not supported.

## Security Considerations

- Always use secure, recommended curves and digest algorithms (e.g., `prime256v1`, `sha256`).
- Never trust a signature without verifying it with the correct public key and digest.
- Handle errors and invalid signatures securely in your application.

## Best Practices

- Validate all inputs before calling this command.
- Use signatures and keys generated by secure cryptographic processes.
- Do not expose private key material or sensitive data in logs or outputs.

## See Also
- `tossl::ec::sign`
- `tossl::key::generate` 