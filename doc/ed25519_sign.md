# ::tossl::ed25519::sign

Sign data using an Ed25519 private key.

## Overview

The `::tossl::ed25519::sign` command creates an Ed25519 digital signature for the given data using the specified private key. Ed25519 provides deterministic signatures and is resistant to timing attacks.

## Syntax

```
::tossl::ed25519::sign <private_key_pem> <data>
```

- `<private_key_pem>`: Ed25519 private key in PEM format
- `<data>`: The message (string or byte array) to sign

## Example

```tcl
set priv [tossl::ed25519::generate]
set data "hello world"
set sig [tossl::ed25519::sign $priv $data]
puts "Signature: $sig"
```

## Return Value

- Returns the signature as a Tcl byte array.
- Returns an error if the key or data is missing or invalid.

## Error Handling

- Returns an error if the private key cannot be parsed.
- Returns an error if the key is not an Ed25519 key.
- Returns an error if the key is a public key (only private keys can sign).
- Returns an error if the wrong number of arguments is provided.

## Security Considerations

- Only use keys generated or obtained from trusted sources.
- Handle all key material and signatures securely.
- Ed25519 provides deterministic signatures (same input always produces same output).
- The algorithm is resistant to timing attacks.
- Do not expose private key material in logs or outputs.

## Best Practices

- Validate all inputs before calling this command.
- Use keys generated by secure cryptographic processes.
- Do not expose sensitive data in logs or outputs.
- Always verify signatures before trusting the authenticity of data.

## Algorithm Details

Ed25519 is an elliptic curve digital signature algorithm based on the Edwards-curve Digital Signature Algorithm (EdDSA) using the Curve25519 elliptic curve. It provides:

- **Deterministic signatures**: Same message and key always produce the same signature
- **High security**: 128-bit security level
- **Fast signing and verification**: Optimized for both operations
- **Compact signatures**: 64-byte signatures
- **Resistance to timing attacks**: Constant-time implementation
- **No random number generation required**: Deterministic by design

## Common Use Cases

### Message Authentication
```tcl
set priv [tossl::ed25519::generate]
set pub [tossl::key::getpub -key $priv]
set message "Important message"
set sig [tossl::ed25519::sign $priv $message]

# Later, verify the message
if {[tossl::ed25519::verify $pub $message $sig]} {
    puts "Message is authentic"
} else {
    puts "Message has been tampered with"
}
```

### Binary Data Signing
```tcl
set priv [tossl::ed25519::generate]
set pub [tossl::key::getpub -key $priv]
set binary_data [binary format H* "0102030405060708"]
set sig [tossl::ed25519::sign $priv $binary_data]

# Verify binary data
if {[tossl::ed25519::verify $pub $binary_data $sig]} {
    puts "Binary data is authentic"
}
```

### File Integrity
```tcl
set priv [tossl::ed25519::generate]
set pub [tossl::key::getpub -key $priv]

# Sign file content
set file_content [read [open "important.txt" r]]
set sig [tossl::ed25519::sign $priv $file_content]

# Store signature for later verification
puts "File signature: $sig"
```

## Performance Considerations

- Ed25519 signing is very fast, typically faster than RSA signing.
- Signature generation is deterministic and doesn't require random number generation.
- Memory usage is minimal and constant regardless of message size.
- The algorithm is optimized for both signing and verification speed.

## Signature Properties

- **Length**: Ed25519 signatures are always 64 bytes long.
- **Deterministic**: The same private key and message always produce the same signature.
- **Compact**: Signatures are much smaller than RSA signatures for equivalent security.
- **Binary**: Signatures are returned as byte arrays, not printable strings.

## Comparison with Other Algorithms

| Algorithm | Signature Size | Security Level | Performance | Deterministic |
|-----------|----------------|----------------|-------------|---------------|
| Ed25519   | 64 bytes       | 128 bits       | Very fast   | Yes           |
| RSA-2048  | 256 bytes      | 112 bits       | Slower      | No            |
| ECDSA     | 64-128 bytes   | 128 bits       | Fast        | No            |

## See Also
- `::tossl::ed25519::verify`
- `::tossl::ed25519::generate`
- `::tossl::key::getpub`
- `::tossl::ed448::sign`
- `::tossl::ed448::verify` 