load ./libtossl.so; set keypair [tossl::key::generate rsa 2048]; set privkey [dict get $keypair private]; set pubkey [dict get $keypair public]; set csr [tossl::csr::create -subject "CN=test.example.com" -pubkey $pubkey -privkey $privkey]; puts "Original CSR:"; puts [tossl::csr::parse $csr]; set modified_csr [tossl::csr::modify -csr $csr -add_extension "subjectAltName" "DNS:test.example.com,DNS:www.test.example.com" 0]; puts "Modified CSR:"; puts [tossl::csr::parse $modified_csr]; puts "CSR valid: [tossl::csr::validate $modified_csr]"
